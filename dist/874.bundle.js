"use strict";(self.webpackChunkreaction_diffusion_font=self.webpackChunkreaction_diffusion_font||[]).push([[874],{874:(e,t,n)=>{n.d(t,{openDrawingEditor:()=>k});var a=n(108),d=n(280);let i=null,o=null,l=null,r=null,c=null,s=null,u=null,g=!1,m="brush",h="seed",p=20,y=!1,w=[],v=[],b=-1;const f=20;let E=!0,I=!0;function k(e={}){const{existingSeed:t=null,existingBoundary:n=null}=e;var d;i||function(){i=document.createElement("div"),i.id="drawing-editor-modal",i.className="drawing-editor-modal",i.innerHTML='\n    <div class="drawing-editor-container">\n      <div class="drawing-editor-header">\n        <h2>Drawing Editor</h2>\n        <button class="close-button" id="drawing-editor-close">‚úï</button>\n      </div>\n      \n      <div class="drawing-editor-controls">\n        <div class="control-group">\n          <label>Active Layer:</label>\n          <select id="drawing-layer-select">\n            <option value="seed">Seed Pattern (Green)</option>\n            <option value="boundary">Boundary Walls (Red) - Erase to allow pattern</option>\n          </select>\n        </div>\n        \n        <div class="control-group">\n          <label>\n            <input type="checkbox" id="drawing-show-seed" checked>\n            Show Seed Layer\n          </label>\n          <label>\n            <input type="checkbox" id="drawing-show-boundary" checked>\n            Show Boundary Layer\n          </label>\n        </div>\n        \n        <div class="control-group">\n          <label>Tool:</label>\n          <button class="tool-button active" data-tool="brush">üñåÔ∏è Draw Wall</button>\n          <button class="tool-button" data-tool="eraser">üßπ Erase (Allow Pattern)</button>\n        </div>\n        \n        <div class="control-group">\n          <label>Brush Size: <span id="drawing-brush-size-value">20</span>px</label>\n          <input type="range" id="drawing-brush-size" min="1" max="100" value="20">\n        </div>\n      </div>\n      \n      <div class="drawing-canvas-container">\n        <canvas id="drawing-canvas-composite"></canvas>\n      </div>\n      \n      <div class="drawing-editor-actions">\n        <div class="action-group">\n          <button id="drawing-undo">‚Ü∂ Undo</button>\n          <button id="drawing-redo">‚Ü∑ Redo</button>\n          <button id="drawing-clear-layer">Clear Layer</button>\n        </div>\n        \n        <div class="action-group">\n          <button id="drawing-import-seed">üìÅ Import Seed Image</button>\n          <button id="drawing-import-boundary">üìÅ Import Boundary Image</button>\n        </div>\n        \n        <div class="action-group">\n          <button id="drawing-export-seed">üíæ Export Seed</button>\n          <button id="drawing-export-boundary">üíæ Export Boundary</button>\n        </div>\n        \n        <div class="action-group primary">\n          <button id="drawing-cancel">Cancel</button>\n          <button id="drawing-apply" class="primary-button">Apply to Simulation</button>\n        </div>\n      </div>\n    </div>\n  ',document.body.appendChild(i);const e=document.createElement("input");e.type="file",e.id="drawing-seed-file-input",e.accept="image/*",e.style.display="none",document.body.appendChild(e);const t=document.createElement("input");t.type="file",t.id="drawing-boundary-file-input",t.accept="image/*",t.style.display="none",document.body.appendChild(t)}(),function(){const e=a.A.canvas.width,t=a.A.canvas.height;r=document.getElementById("drawing-canvas-composite"),r.width=e,r.height=t,u=r.getContext("2d",{willReadFrequently:!0}),o=document.createElement("canvas"),o.width=e,o.height=t,c=o.getContext("2d",{willReadFrequently:!0}),l=document.createElement("canvas"),l.width=e,l.height=t,s=l.getContext("2d",{willReadFrequently:!0})}(),g||(function(){document.getElementById("drawing-editor-close").addEventListener("click",B),document.getElementById("drawing-cancel").addEventListener("click",B),document.getElementById("drawing-layer-select").addEventListener("change",e=>{h=e.target.value,R()}),document.getElementById("drawing-show-seed").addEventListener("change",e=>{E=e.target.checked,R()}),document.getElementById("drawing-show-boundary").addEventListener("change",e=>{I=e.target.checked,R()}),document.querySelectorAll(".tool-button").forEach(e=>{e.addEventListener("click",e=>{document.querySelectorAll(".tool-button").forEach(e=>e.classList.remove("active")),e.target.classList.add("active"),m=e.target.dataset.tool})});const e=document.getElementById("drawing-brush-size"),t=document.getElementById("drawing-brush-size-value");e.addEventListener("input",e=>{p=parseInt(e.target.value),t.textContent=p}),r.addEventListener("mousedown",C),r.addEventListener("mousemove",D),r.addEventListener("mouseup",x),r.addEventListener("mouseleave",x),document.getElementById("drawing-undo").addEventListener("click",q),document.getElementById("drawing-redo").addEventListener("click",O),document.getElementById("drawing-clear-layer").addEventListener("click",()=>{A(h),z(),R()}),document.getElementById("drawing-import-seed").addEventListener("click",()=>{document.getElementById("drawing-seed-file-input").click()}),document.getElementById("drawing-import-boundary").addEventListener("click",()=>{document.getElementById("drawing-boundary-file-input").click()}),document.getElementById("drawing-seed-file-input").addEventListener("change",e=>{M(e.target.files[0],"seed")}),document.getElementById("drawing-boundary-file-input").addEventListener("change",e=>{M(e.target.files[0],"boundary")}),document.getElementById("drawing-export-seed").addEventListener("click",()=>F("seed")),document.getElementById("drawing-export-boundary").addEventListener("click",()=>F("boundary")),document.getElementById("drawing-apply").addEventListener("click",P),document.addEventListener("keydown",L)}(),g=!0),t?(d=t,c.putImageData(d,0,0)):A("seed"),n?function(e){const t=l.width,n=l.height,a=s.createImageData(t,n);for(let t=0;t<e.length;t++){const n=e[t]>.5?0:255;a.data[4*t]=n,a.data[4*t+1]=n,a.data[4*t+2]=n,a.data[4*t+3]=255}s.putImageData(a,0,0)}(n):A("boundary"),z(),i.style.display="flex",R(),console.log("Drawing editor opened")}function B(){i&&(i.style.display="none")}function L(e){i&&"none"!==i.style.display&&("b"===e.key||"B"===e.key?(m="brush",document.querySelector('[data-tool="brush"]').click()):"e"===e.key||"E"===e.key?(m="eraser",document.querySelector('[data-tool="eraser"]').click()):e.ctrlKey&&"z"===e.key?(e.preventDefault(),q()):e.ctrlKey&&"y"===e.key?(e.preventDefault(),O()):"["===e.key?(p=Math.max(1,p-5),document.getElementById("drawing-brush-size").value=p,document.getElementById("drawing-brush-size-value").textContent=p):"]"===e.key&&(p=Math.min(100,p+5),document.getElementById("drawing-brush-size").value=p,document.getElementById("drawing-brush-size-value").textContent=p))}function C(e){y=!0;const t=r.getBoundingClientRect();S(e.clientX-t.left,e.clientY-t.top)}function D(e){if(!y)return;const t=r.getBoundingClientRect();S(e.clientX-t.left,e.clientY-t.top)}function x(){y&&(y=!1,z())}function S(e,t){const n="seed"===h?c:s;n.globalCompositeOperation="brush"===m?"source-over":"destination-out",n.fillStyle="#000",n.beginPath(),n.arc(e,t,p/2,0,2*Math.PI),n.fill(),R()}function R(){if(u.fillStyle="#fff",u.fillRect(0,0,r.width,r.height),E&&(u.globalAlpha=1,u.globalCompositeOperation="source-over",u.drawImage(o,0,0),u.globalCompositeOperation="multiply",u.fillStyle="rgba(100, 255, 100, 1.0)",u.fillRect(0,0,r.width,r.height),u.globalCompositeOperation="source-over"),I){u.globalAlpha=1,u.globalCompositeOperation="source-over";const e=document.createElement("canvas");e.width=l.width,e.height=l.height;const t=e.getContext("2d");t.drawImage(l,0,0),t.globalCompositeOperation="source-in",t.fillStyle="rgba(255, 50, 50, 0.7)",t.fillRect(0,0,e.width,e.height),u.drawImage(e,0,0),u.globalCompositeOperation="source-over"}}function A(e){const t="seed"===e?c:s;"seed"===e?(t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height)):(t.fillStyle="#000",t.fillRect(0,0,t.canvas.width,t.canvas.height))}function z(){b<w.length-1&&(w=w.slice(0,b+1),v=v.slice(0,b+1)),w.push(c.getImageData(0,0,o.width,o.height)),v.push(s.getImageData(0,0,l.width,l.height)),b++,w.length>f&&(w.shift(),v.shift(),b--)}function q(){b>0&&(b--,c.putImageData(w[b],0,0),s.putImageData(v[b],0,0),R())}function O(){b<w.length-1&&(b++,c.putImageData(w[b],0,0),s.putImageData(v[b],0,0),R())}function M(e,t){if(!e)return;const n=new FileReader;n.onload=e=>{const n=new Image;n.onload=()=>{const e="seed"===t?c:s;e.fillStyle="#fff",e.fillRect(0,0,e.canvas.width,e.canvas.height);const a=Math.min(e.canvas.width/n.width,e.canvas.height/n.height),d=(e.canvas.width-n.width*a)/2,i=(e.canvas.height-n.height*a)/2;e.drawImage(n,d,i,n.width*a,n.height*a),z(),R(),console.log(`Imported image to ${t} layer`)},n.src=e.target.result},n.readAsDataURL(e)}function F(e){const t=("seed"===e?o:l).toDataURL("image/png"),n=document.createElement("a");n.download=`${e}-${Date.now()}.png`,n.href=t,n.click(),console.log(`Exported ${e} layer`)}function P(){const e=c.getImageData(0,0,o.width,o.height),t=s.getImageData(0,0,l.width,l.height);let i=!1;for(let e=3;e<t.data.length;e+=4)if(t.data[e]>128){i=!0;break}n.g.customDrawingSeed=e,n.g.customDrawingBoundary=t,i&&(a.A.boundary.enabled=!0,console.log("Boundary drawing detected - enabling boundary conditions")),B(),(0,d.qM)(d.ph.DRAWING),console.log("Applied drawing to simulation",{hasBoundary:i,boundaryEnabled:a.A.boundary.enabled})}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVFDLElBQUkscUJBQXFCNkIsWUFFbkNTLEVBQUlHLElBQU1qRixFQUFFQyxPQUFPaUYsUUFFckJQLEVBQU9RLGNBQWNULEVBQ3ZCLENBS0EsU0FBUzlDLEVBQVl5QyxHQUNuQixNQUNNZSxHQURtQixTQUFWZixFQUFtQmxILEVBQWFDLEdBQ3hCaUksVUFBVSxhQUUzQkMsRUFBTzdHLFNBQVNDLGNBQWMsS0FDcEM0RyxFQUFLQyxTQUFXLEdBQUdsQixLQUFTbUIsS0FBS0MsWUFDakNILEVBQUtJLEtBQU9OLEVBQ1pFLEVBQUs3RCxRQUVMYyxRQUFRQyxJQUFJLFlBQVk2QixVQUMxQixDQUtBLFNBQVN4QyxJQUVQLE1BQU04RCxFQUFnQnJJLEVBQVFrSCxhQUFhLEVBQUcsRUFBR3JILEVBQVdvQyxNQUFPcEMsRUFBV3NDLFFBR3hFbUcsRUFBb0JySSxFQUFZaUgsYUFBYSxFQUFHLEVBQUdwSCxFQUFlbUMsTUFBT25DLEVBQWVxQyxRQUc5RixJQUFJb0csR0FBcUIsRUFDekIsSUFBSyxJQUFJMUQsRUFBSSxFQUFHQSxFQUFJeUQsRUFBa0J2RCxLQUFLRCxPQUFRRCxHQUFLLEVBQ3RELEdBQUl5RCxFQUFrQnZELEtBQUtGLEdBQUssSUFBSyxDQUNuQzBELEdBQXFCLEVBQ3JCLEtBQ0YsQ0FJRixFQUFBQyxFQUFPQyxrQkFBb0JKLEVBQzNCLEVBQUFHLEVBQU9FLHNCQUF3QkosRUFHM0JDLElBQ0YsSUFBZ0JJLFNBQVNDLFNBQVUsRUFDbkMzRCxRQUFRQyxJQUFJLDZEQUlkekMsS0FHQSxRQUFlLEtBQW9Cb0csU0FFbkM1RCxRQUFRQyxJQUFJLGdDQUFpQyxDQUMzQzRELFlBQWFQLEVBQ2JRLGdCQUFpQixJQUFnQkosU0FBU0MsU0FFOUMsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3JlYWN0aW9uLWRpZmZ1c2lvbi1mb250Ly4vanMvZHJhd2luZ0VkaXRvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyAgRFJBV0lORyBFRElUT1Jcbi8vICAtIE1vZGFsIHdpdGggZHVhbC1sYXllciBjYW52YXMgZm9yIGRyYXdpbmcgc2VlZHMgYW5kIGJvdW5kYXJpZXNcbi8vICAtIENhbiBsb2FkIGFuZCBlZGl0IGV4aXN0aW5nIHBhdHRlcm5zXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBwYXJhbWV0ZXJWYWx1ZXMgZnJvbSAnLi9wYXJhbWV0ZXJWYWx1ZXMnO1xuaW1wb3J0IHsgZHJhd0ZpcnN0RnJhbWUsIEluaXRpYWxUZXh0dXJlVHlwZXMgfSBmcm9tICcuL2ZpcnN0RnJhbWUnO1xuXG5sZXQgbW9kYWwgPSBudWxsO1xubGV0IHNlZWRDYW52YXMgPSBudWxsO1xubGV0IGJvdW5kYXJ5Q2FudmFzID0gbnVsbDtcbmxldCBjb21wb3NpdGVDYW52YXMgPSBudWxsO1xubGV0IHNlZWRDdHggPSBudWxsO1xubGV0IGJvdW5kYXJ5Q3R4ID0gbnVsbDtcbmxldCBjb21wb3NpdGVDdHggPSBudWxsO1xubGV0IGV2ZW50TGlzdGVuZXJzU2V0dXAgPSBmYWxzZTsgIC8vIFRyYWNrIGlmIGV2ZW50IGxpc3RlbmVycyBhcmUgYWxyZWFkeSBhdHRhY2hlZFxuXG5sZXQgY3VycmVudFRvb2wgPSAnYnJ1c2gnOyAgLy8gJ2JydXNoJyBvciAnZXJhc2VyJ1xubGV0IGN1cnJlbnRMYXllciA9ICdzZWVkJzsgIC8vICdzZWVkJyBvciAnYm91bmRhcnknXG5sZXQgYnJ1c2hTaXplID0gMjA7XG5sZXQgaXNEcmF3aW5nID0gZmFsc2U7XG5cbi8vIFVuZG8vcmVkbyBzdGFja3NcbmxldCBzZWVkSGlzdG9yeSA9IFtdO1xubGV0IGJvdW5kYXJ5SGlzdG9yeSA9IFtdO1xubGV0IGhpc3RvcnlJbmRleCA9IC0xO1xuY29uc3QgTUFYX0hJU1RPUlkgPSAyMDtcblxuLy8gTGF5ZXIgdmlzaWJpbGl0eVxubGV0IHNob3dTZWVkID0gdHJ1ZTtcbmxldCBzaG93Qm91bmRhcnkgPSB0cnVlO1xuXG4vKipcbiAqIE9wZW4gdGhlIGRyYXdpbmcgZWRpdG9yIG1vZGFsXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIENvbmZpZ3VyYXRpb25cbiAqIEBwYXJhbSB7SW1hZ2VEYXRhfSBvcHRpb25zLmV4aXN0aW5nU2VlZCAtIEV4aXN0aW5nIHNlZWQgcGF0dGVybiB0byBlZGl0XG4gKiBAcGFyYW0ge0Zsb2F0MzJBcnJheX0gb3B0aW9ucy5leGlzdGluZ0JvdW5kYXJ5IC0gRXhpc3RpbmcgYm91bmRhcnkgbWFzayB0byBlZGl0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvcGVuRHJhd2luZ0VkaXRvcihvcHRpb25zID0ge30pIHtcbiAgY29uc3QgeyBleGlzdGluZ1NlZWQgPSBudWxsLCBleGlzdGluZ0JvdW5kYXJ5ID0gbnVsbCB9ID0gb3B0aW9ucztcbiAgXG4gIC8vIENyZWF0ZSBtb2RhbCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gIGlmICghbW9kYWwpIHtcbiAgICBjcmVhdGVNb2RhbCgpO1xuICB9XG4gIFxuICAvLyBJbml0aWFsaXplIGNhbnZhc2VzXG4gIGluaXRpYWxpemVDYW52YXNlcygpO1xuICBcbiAgLy8gU2V0dXAgZXZlbnQgbGlzdGVuZXJzIChtdXN0IGJlIGFmdGVyIGluaXRpYWxpemVDYW52YXNlcywgb25seSBvbmNlKVxuICBpZiAoIWV2ZW50TGlzdGVuZXJzU2V0dXApIHtcbiAgICBzZXR1cEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgZXZlbnRMaXN0ZW5lcnNTZXR1cCA9IHRydWU7XG4gIH1cbiAgXG4gIC8vIExvYWQgZXhpc3RpbmcgZGF0YSBpZiBwcm92aWRlZFxuICBpZiAoZXhpc3RpbmdTZWVkKSB7XG4gICAgbG9hZFNlZWREYXRhKGV4aXN0aW5nU2VlZCk7XG4gIH0gZWxzZSB7XG4gICAgY2xlYXJMYXllcignc2VlZCcpO1xuICB9XG4gIFxuICBpZiAoZXhpc3RpbmdCb3VuZGFyeSkge1xuICAgIGxvYWRCb3VuZGFyeURhdGEoZXhpc3RpbmdCb3VuZGFyeSk7XG4gIH0gZWxzZSB7XG4gICAgY2xlYXJMYXllcignYm91bmRhcnknKTtcbiAgfVxuICBcbiAgLy8gU2F2ZSBpbml0aWFsIHN0YXRlIHRvIGhpc3RvcnlcbiAgc2F2ZVRvSGlzdG9yeSgpO1xuICBcbiAgLy8gU2hvdyBtb2RhbFxuICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICBcbiAgLy8gVXBkYXRlIGNvbXBvc2l0ZSB2aWV3XG4gIHVwZGF0ZUNvbXBvc2l0ZSgpO1xuICBcbiAgY29uc29sZS5sb2coJ0RyYXdpbmcgZWRpdG9yIG9wZW5lZCcpO1xufVxuXG4vKipcbiAqIENsb3NlIHRoZSBkcmF3aW5nIGVkaXRvciBtb2RhbFxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VEcmF3aW5nRWRpdG9yKCkge1xuICBpZiAobW9kYWwpIHtcbiAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIHRoZSBtb2RhbCBIVE1MIHN0cnVjdHVyZVxuICovXG5mdW5jdGlvbiBjcmVhdGVNb2RhbCgpIHtcbiAgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgbW9kYWwuaWQgPSAnZHJhd2luZy1lZGl0b3ItbW9kYWwnO1xuICBtb2RhbC5jbGFzc05hbWUgPSAnZHJhd2luZy1lZGl0b3ItbW9kYWwnO1xuICBcbiAgbW9kYWwuaW5uZXJIVE1MID0gYFxuICAgIDxkaXYgY2xhc3M9XCJkcmF3aW5nLWVkaXRvci1jb250YWluZXJcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJkcmF3aW5nLWVkaXRvci1oZWFkZXJcIj5cbiAgICAgICAgPGgyPkRyYXdpbmcgRWRpdG9yPC9oMj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImNsb3NlLWJ1dHRvblwiIGlkPVwiZHJhd2luZy1lZGl0b3ItY2xvc2VcIj7inJU8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgXG4gICAgICA8ZGl2IGNsYXNzPVwiZHJhd2luZy1lZGl0b3ItY29udHJvbHNcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2wtZ3JvdXBcIj5cbiAgICAgICAgICA8bGFiZWw+QWN0aXZlIExheWVyOjwvbGFiZWw+XG4gICAgICAgICAgPHNlbGVjdCBpZD1cImRyYXdpbmctbGF5ZXItc2VsZWN0XCI+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwic2VlZFwiPlNlZWQgUGF0dGVybiAoR3JlZW4pPC9vcHRpb24+XG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiYm91bmRhcnlcIj5Cb3VuZGFyeSBXYWxscyAoUmVkKSAtIEVyYXNlIHRvIGFsbG93IHBhdHRlcm48L29wdGlvbj5cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbC1ncm91cFwiPlxuICAgICAgICAgIDxsYWJlbD5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImRyYXdpbmctc2hvdy1zZWVkXCIgY2hlY2tlZD5cbiAgICAgICAgICAgIFNob3cgU2VlZCBMYXllclxuICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwiZHJhd2luZy1zaG93LWJvdW5kYXJ5XCIgY2hlY2tlZD5cbiAgICAgICAgICAgIFNob3cgQm91bmRhcnkgTGF5ZXJcbiAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250cm9sLWdyb3VwXCI+XG4gICAgICAgICAgPGxhYmVsPlRvb2w6PC9sYWJlbD5cbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwidG9vbC1idXR0b24gYWN0aXZlXCIgZGF0YS10b29sPVwiYnJ1c2hcIj7wn5aM77iPIERyYXcgV2FsbDwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJ0b29sLWJ1dHRvblwiIGRhdGEtdG9vbD1cImVyYXNlclwiPvCfp7kgRXJhc2UgKEFsbG93IFBhdHRlcm4pPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICBcbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2wtZ3JvdXBcIj5cbiAgICAgICAgICA8bGFiZWw+QnJ1c2ggU2l6ZTogPHNwYW4gaWQ9XCJkcmF3aW5nLWJydXNoLXNpemUtdmFsdWVcIj4yMDwvc3Bhbj5weDwvbGFiZWw+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJyYW5nZVwiIGlkPVwiZHJhd2luZy1icnVzaC1zaXplXCIgbWluPVwiMVwiIG1heD1cIjEwMFwiIHZhbHVlPVwiMjBcIj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIFxuICAgICAgPGRpdiBjbGFzcz1cImRyYXdpbmctY2FudmFzLWNvbnRhaW5lclwiPlxuICAgICAgICA8Y2FudmFzIGlkPVwiZHJhd2luZy1jYW52YXMtY29tcG9zaXRlXCI+PC9jYW52YXM+XG4gICAgICA8L2Rpdj5cbiAgICAgIFxuICAgICAgPGRpdiBjbGFzcz1cImRyYXdpbmctZWRpdG9yLWFjdGlvbnNcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImFjdGlvbi1ncm91cFwiPlxuICAgICAgICAgIDxidXR0b24gaWQ9XCJkcmF3aW5nLXVuZG9cIj7ihrYgVW5kbzwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gaWQ9XCJkcmF3aW5nLXJlZG9cIj7ihrcgUmVkbzwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gaWQ9XCJkcmF3aW5nLWNsZWFyLWxheWVyXCI+Q2xlYXIgTGF5ZXI8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uLWdyb3VwXCI+XG4gICAgICAgICAgPGJ1dHRvbiBpZD1cImRyYXdpbmctaW1wb3J0LXNlZWRcIj7wn5OBIEltcG9ydCBTZWVkIEltYWdlPC9idXR0b24+XG4gICAgICAgICAgPGJ1dHRvbiBpZD1cImRyYXdpbmctaW1wb3J0LWJvdW5kYXJ5XCI+8J+TgSBJbXBvcnQgQm91bmRhcnkgSW1hZ2U8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uLWdyb3VwXCI+XG4gICAgICAgICAgPGJ1dHRvbiBpZD1cImRyYXdpbmctZXhwb3J0LXNlZWRcIj7wn5K+IEV4cG9ydCBTZWVkPC9idXR0b24+XG4gICAgICAgICAgPGJ1dHRvbiBpZD1cImRyYXdpbmctZXhwb3J0LWJvdW5kYXJ5XCI+8J+SviBFeHBvcnQgQm91bmRhcnk8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uLWdyb3VwIHByaW1hcnlcIj5cbiAgICAgICAgICA8YnV0dG9uIGlkPVwiZHJhd2luZy1jYW5jZWxcIj5DYW5jZWw8L2J1dHRvbj5cbiAgICAgICAgICA8YnV0dG9uIGlkPVwiZHJhd2luZy1hcHBseVwiIGNsYXNzPVwicHJpbWFyeS1idXR0b25cIj5BcHBseSB0byBTaW11bGF0aW9uPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGA7XG4gIFxuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcbiAgXG4gIC8vIENyZWF0ZSBoaWRkZW4gZmlsZSBpbnB1dHMgZm9yIGltcG9ydFxuICBjb25zdCBzZWVkRmlsZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgc2VlZEZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICBzZWVkRmlsZUlucHV0LmlkID0gJ2RyYXdpbmctc2VlZC1maWxlLWlucHV0JztcbiAgc2VlZEZpbGVJbnB1dC5hY2NlcHQgPSAnaW1hZ2UvKic7XG4gIHNlZWRGaWxlSW5wdXQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzZWVkRmlsZUlucHV0KTtcbiAgXG4gIGNvbnN0IGJvdW5kYXJ5RmlsZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgYm91bmRhcnlGaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgYm91bmRhcnlGaWxlSW5wdXQuaWQgPSAnZHJhd2luZy1ib3VuZGFyeS1maWxlLWlucHV0JztcbiAgYm91bmRhcnlGaWxlSW5wdXQuYWNjZXB0ID0gJ2ltYWdlLyonO1xuICBib3VuZGFyeUZpbGVJbnB1dC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJvdW5kYXJ5RmlsZUlucHV0KTtcbiAgXG4gIC8vIE5PVEU6IEV2ZW50IGxpc3RlbmVycyB3aWxsIGJlIHNldCB1cCBhZnRlciBjYW52YXNlcyBhcmUgaW5pdGlhbGl6ZWRcbn1cblxuLyoqXG4gKiBJbml0aWFsaXplIGNhbnZhcyBlbGVtZW50c1xuICovXG5mdW5jdGlvbiBpbml0aWFsaXplQ2FudmFzZXMoKSB7XG4gIGNvbnN0IHdpZHRoID0gcGFyYW1ldGVyVmFsdWVzLmNhbnZhcy53aWR0aDtcbiAgY29uc3QgaGVpZ2h0ID0gcGFyYW1ldGVyVmFsdWVzLmNhbnZhcy5oZWlnaHQ7XG4gIFxuICAvLyBDb21wb3NpdGUgY2FudmFzICh2aXNpYmxlKVxuICBjb21wb3NpdGVDYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1jYW52YXMtY29tcG9zaXRlJyk7XG4gIGNvbXBvc2l0ZUNhbnZhcy53aWR0aCA9IHdpZHRoO1xuICBjb21wb3NpdGVDYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICBjb21wb3NpdGVDdHggPSBjb21wb3NpdGVDYW52YXMuZ2V0Q29udGV4dCgnMmQnLCB7IHdpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZSB9KTtcbiAgXG4gIC8vIFNlZWQgbGF5ZXIgKG9mZnNjcmVlbilcbiAgc2VlZENhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICBzZWVkQ2FudmFzLndpZHRoID0gd2lkdGg7XG4gIHNlZWRDYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICBzZWVkQ3R4ID0gc2VlZENhbnZhcy5nZXRDb250ZXh0KCcyZCcsIHsgd2lsbFJlYWRGcmVxdWVudGx5OiB0cnVlIH0pO1xuICBcbiAgLy8gQm91bmRhcnkgbGF5ZXIgKG9mZnNjcmVlbilcbiAgYm91bmRhcnlDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgYm91bmRhcnlDYW52YXMud2lkdGggPSB3aWR0aDtcbiAgYm91bmRhcnlDYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICBib3VuZGFyeUN0eCA9IGJvdW5kYXJ5Q2FudmFzLmdldENvbnRleHQoJzJkJywgeyB3aWxsUmVhZEZyZXF1ZW50bHk6IHRydWUgfSk7XG59XG5cbi8qKlxuICogU2V0dXAgYWxsIGV2ZW50IGxpc3RlbmVyc1xuICovXG5mdW5jdGlvbiBzZXR1cEV2ZW50TGlzdGVuZXJzKCkge1xuICAvLyBDbG9zZSBidXR0b25cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctZWRpdG9yLWNsb3NlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZURyYXdpbmdFZGl0b3IpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1jYW5jZWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRHJhd2luZ0VkaXRvcik7XG4gIFxuICAvLyBMYXllciBzZWxlY3Rpb25cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctbGF5ZXItc2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICBjdXJyZW50TGF5ZXIgPSBlLnRhcmdldC52YWx1ZTtcbiAgICB1cGRhdGVDb21wb3NpdGUoKTtcbiAgfSk7XG4gIFxuICAvLyBMYXllciB2aXNpYmlsaXR5IHRvZ2dsZXNcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctc2hvdy1zZWVkJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICBzaG93U2VlZCA9IGUudGFyZ2V0LmNoZWNrZWQ7XG4gICAgdXBkYXRlQ29tcG9zaXRlKCk7XG4gIH0pO1xuICBcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctc2hvdy1ib3VuZGFyeScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgc2hvd0JvdW5kYXJ5ID0gZS50YXJnZXQuY2hlY2tlZDtcbiAgICB1cGRhdGVDb21wb3NpdGUoKTtcbiAgfSk7XG4gIFxuICAvLyBUb29sIHNlbGVjdGlvblxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9vbC1idXR0b24nKS5mb3JFYWNoKGJ0biA9PiB7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b29sLWJ1dHRvbicpLmZvckVhY2goYiA9PiBiLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgY3VycmVudFRvb2wgPSBlLnRhcmdldC5kYXRhc2V0LnRvb2w7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgLy8gQnJ1c2ggc2l6ZVxuICBjb25zdCBicnVzaFNpemVTbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1icnVzaC1zaXplJyk7XG4gIGNvbnN0IGJydXNoU2l6ZVZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctYnJ1c2gtc2l6ZS12YWx1ZScpO1xuICBicnVzaFNpemVTbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZSkgPT4ge1xuICAgIGJydXNoU2l6ZSA9IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlKTtcbiAgICBicnVzaFNpemVWYWx1ZS50ZXh0Q29udGVudCA9IGJydXNoU2l6ZTtcbiAgfSk7XG4gIFxuICAvLyBEcmF3aW5nIG9uIGNvbXBvc2l0ZSBjYW52YXNcbiAgY29tcG9zaXRlQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN0YXJ0RHJhd2luZyk7XG4gIGNvbXBvc2l0ZUNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBkcmF3KTtcbiAgY29tcG9zaXRlQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzdG9wRHJhd2luZyk7XG4gIGNvbXBvc2l0ZUNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgc3RvcERyYXdpbmcpO1xuICBcbiAgLy8gVW5kby9SZWRvXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLXVuZG8nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHVuZG8pO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1yZWRvJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZWRvKTtcbiAgXG4gIC8vIENsZWFyIGxheWVyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLWNsZWFyLWxheWVyJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY2xlYXJMYXllcihjdXJyZW50TGF5ZXIpO1xuICAgIHNhdmVUb0hpc3RvcnkoKTtcbiAgICB1cGRhdGVDb21wb3NpdGUoKTtcbiAgfSk7XG4gIFxuICAvLyBJbXBvcnRcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctaW1wb3J0LXNlZWQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1zZWVkLWZpbGUtaW5wdXQnKS5jbGljaygpO1xuICB9KTtcbiAgXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLWltcG9ydC1ib3VuZGFyeScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLWJvdW5kYXJ5LWZpbGUtaW5wdXQnKS5jbGljaygpO1xuICB9KTtcbiAgXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLXNlZWQtZmlsZS1pbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgaW1wb3J0SW1hZ2UoZS50YXJnZXQuZmlsZXNbMF0sICdzZWVkJyk7XG4gIH0pO1xuICBcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctYm91bmRhcnktZmlsZS1pbnB1dCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgaW1wb3J0SW1hZ2UoZS50YXJnZXQuZmlsZXNbMF0sICdib3VuZGFyeScpO1xuICB9KTtcbiAgXG4gIC8vIEV4cG9ydFxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1leHBvcnQtc2VlZCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gZXhwb3J0TGF5ZXIoJ3NlZWQnKSk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLWV4cG9ydC1ib3VuZGFyeScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gZXhwb3J0TGF5ZXIoJ2JvdW5kYXJ5JykpO1xuICBcbiAgLy8gQXBwbHlcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctYXBwbHknKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFwcGx5RHJhd2luZyk7XG4gIFxuICAvLyBLZXlib2FyZCBzaG9ydGN1dHNcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleWJvYXJkKTtcbn1cblxuLyoqXG4gKiBIYW5kbGUga2V5Ym9hcmQgc2hvcnRjdXRzXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUtleWJvYXJkKGUpIHtcbiAgLy8gT25seSBoYW5kbGUgaWYgbW9kYWwgaXMgb3BlblxuICBpZiAoIW1vZGFsIHx8IG1vZGFsLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykgcmV0dXJuO1xuICBcbiAgaWYgKGUua2V5ID09PSAnYicgfHwgZS5rZXkgPT09ICdCJykge1xuICAgIGN1cnJlbnRUb29sID0gJ2JydXNoJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10b29sPVwiYnJ1c2hcIl0nKS5jbGljaygpO1xuICB9IGVsc2UgaWYgKGUua2V5ID09PSAnZScgfHwgZS5rZXkgPT09ICdFJykge1xuICAgIGN1cnJlbnRUb29sID0gJ2VyYXNlcic7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdG9vbD1cImVyYXNlclwiXScpLmNsaWNrKCk7XG4gIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUua2V5ID09PSAneicpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdW5kbygpO1xuICB9IGVsc2UgaWYgKGUuY3RybEtleSAmJiBlLmtleSA9PT0gJ3knKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHJlZG8oKTtcbiAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ1snKSB7XG4gICAgYnJ1c2hTaXplID0gTWF0aC5tYXgoMSwgYnJ1c2hTaXplIC0gNSk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctYnJ1c2gtc2l6ZScpLnZhbHVlID0gYnJ1c2hTaXplO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmF3aW5nLWJydXNoLXNpemUtdmFsdWUnKS50ZXh0Q29udGVudCA9IGJydXNoU2l6ZTtcbiAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ10nKSB7XG4gICAgYnJ1c2hTaXplID0gTWF0aC5taW4oMTAwLCBicnVzaFNpemUgKyA1KTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHJhd2luZy1icnVzaC1zaXplJykudmFsdWUgPSBicnVzaFNpemU7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYXdpbmctYnJ1c2gtc2l6ZS12YWx1ZScpLnRleHRDb250ZW50ID0gYnJ1c2hTaXplO1xuICB9XG59XG5cbi8qKlxuICogU3RhcnQgZHJhd2luZ1xuICovXG5mdW5jdGlvbiBzdGFydERyYXdpbmcoZSkge1xuICBpc0RyYXdpbmcgPSB0cnVlO1xuICBjb25zdCByZWN0ID0gY29tcG9zaXRlQ2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICBjb25zdCB4ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0O1xuICBjb25zdCB5ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7XG4gIGRyYXdQb2ludCh4LCB5KTtcbn1cblxuLyoqXG4gKiBEcmF3IHdoaWxlIG1vdmluZ1xuICovXG5mdW5jdGlvbiBkcmF3KGUpIHtcbiAgaWYgKCFpc0RyYXdpbmcpIHJldHVybjtcbiAgXG4gIGNvbnN0IHJlY3QgPSBjb21wb3NpdGVDYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IHggPSBlLmNsaWVudFggLSByZWN0LmxlZnQ7XG4gIGNvbnN0IHkgPSBlLmNsaWVudFkgLSByZWN0LnRvcDtcbiAgZHJhd1BvaW50KHgsIHkpO1xufVxuXG4vKipcbiAqIFN0b3AgZHJhd2luZ1xuICovXG5mdW5jdGlvbiBzdG9wRHJhd2luZygpIHtcbiAgaWYgKGlzRHJhd2luZykge1xuICAgIGlzRHJhd2luZyA9IGZhbHNlO1xuICAgIHNhdmVUb0hpc3RvcnkoKTtcbiAgfVxufVxuXG4vKipcbiAqIERyYXcgYSBwb2ludCBvbiB0aGUgYWN0aXZlIGxheWVyXG4gKi9cbmZ1bmN0aW9uIGRyYXdQb2ludCh4LCB5KSB7XG4gIGNvbnN0IGN0eCA9IGN1cnJlbnRMYXllciA9PT0gJ3NlZWQnID8gc2VlZEN0eCA6IGJvdW5kYXJ5Q3R4O1xuICBcbiAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IGN1cnJlbnRUb29sID09PSAnYnJ1c2gnID8gJ3NvdXJjZS1vdmVyJyA6ICdkZXN0aW5hdGlvbi1vdXQnO1xuICBjdHguZmlsbFN0eWxlID0gJyMwMDAnO1xuICBjdHguYmVnaW5QYXRoKCk7XG4gIGN0eC5hcmMoeCwgeSwgYnJ1c2hTaXplIC8gMiwgMCwgTWF0aC5QSSAqIDIpO1xuICBjdHguZmlsbCgpO1xuICBcbiAgdXBkYXRlQ29tcG9zaXRlKCk7XG59XG5cbi8qKlxuICogVXBkYXRlIHRoZSBjb21wb3NpdGUgY2FudmFzIHZpZXdcbiAqL1xuZnVuY3Rpb24gdXBkYXRlQ29tcG9zaXRlKCkge1xuICAvLyBDbGVhciBjb21wb3NpdGUgd2l0aCB3aGl0ZSBiYWNrZ3JvdW5kXG4gIGNvbXBvc2l0ZUN0eC5maWxsU3R5bGUgPSAnI2ZmZic7XG4gIGNvbXBvc2l0ZUN0eC5maWxsUmVjdCgwLCAwLCBjb21wb3NpdGVDYW52YXMud2lkdGgsIGNvbXBvc2l0ZUNhbnZhcy5oZWlnaHQpO1xuICBcbiAgLy8gRHJhdyBzZWVkIGxheWVyIChibGFjayBvbiB3aGl0ZSkgd2l0aCBncmVlbiB0aW50XG4gIGlmIChzaG93U2VlZCkge1xuICAgIGNvbXBvc2l0ZUN0eC5nbG9iYWxBbHBoYSA9IDEuMDtcbiAgICBjb21wb3NpdGVDdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcbiAgICBcbiAgICAvLyBEcmF3IHNlZWQgY2FudmFzXG4gICAgY29tcG9zaXRlQ3R4LmRyYXdJbWFnZShzZWVkQ2FudmFzLCAwLCAwKTtcbiAgICBcbiAgICAvLyBBcHBseSBncmVlbiB0aW50IHRvIGJsYWNrIGFyZWFzXG4gICAgY29tcG9zaXRlQ3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdtdWx0aXBseSc7XG4gICAgY29tcG9zaXRlQ3R4LmZpbGxTdHlsZSA9ICdyZ2JhKDEwMCwgMjU1LCAxMDAsIDEuMCknO1xuICAgIGNvbXBvc2l0ZUN0eC5maWxsUmVjdCgwLCAwLCBjb21wb3NpdGVDYW52YXMud2lkdGgsIGNvbXBvc2l0ZUNhbnZhcy5oZWlnaHQpO1xuICAgIGNvbXBvc2l0ZUN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInO1xuICB9XG4gIFxuICAvLyBEcmF3IGJvdW5kYXJ5IGxheWVyIChibGFjayBvbiB0cmFuc3BhcmVudCkgd2l0aCByZWQgdGludFxuICBpZiAoc2hvd0JvdW5kYXJ5KSB7XG4gICAgY29tcG9zaXRlQ3R4Lmdsb2JhbEFscGhhID0gMS4wO1xuICAgIGNvbXBvc2l0ZUN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIHRlbXBvcmFyeSBjYW52YXMgdG8gYXBwbHkgcmVkIHRpbnQgdG8gYm91bmRhcnlcbiAgICBjb25zdCB0ZW1wQ2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgdGVtcENhbnZhcy53aWR0aCA9IGJvdW5kYXJ5Q2FudmFzLndpZHRoO1xuICAgIHRlbXBDYW52YXMuaGVpZ2h0ID0gYm91bmRhcnlDYW52YXMuaGVpZ2h0O1xuICAgIGNvbnN0IHRlbXBDdHggPSB0ZW1wQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgXG4gICAgLy8gRHJhdyBib3VuZGFyeSBjYW52YXNcbiAgICB0ZW1wQ3R4LmRyYXdJbWFnZShib3VuZGFyeUNhbnZhcywgMCwgMCk7XG4gICAgXG4gICAgLy8gQ2hhbmdlIGJsYWNrIHBpeGVscyB0byByZWRcbiAgICB0ZW1wQ3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdzb3VyY2UtaW4nO1xuICAgIHRlbXBDdHguZmlsbFN0eWxlID0gJ3JnYmEoMjU1LCA1MCwgNTAsIDAuNyknO1xuICAgIHRlbXBDdHguZmlsbFJlY3QoMCwgMCwgdGVtcENhbnZhcy53aWR0aCwgdGVtcENhbnZhcy5oZWlnaHQpO1xuICAgIFxuICAgIC8vIERyYXcgdGludGVkIGJvdW5kYXJ5IHRvIGNvbXBvc2l0ZVxuICAgIGNvbXBvc2l0ZUN0eC5kcmF3SW1hZ2UodGVtcENhbnZhcywgMCwgMCk7XG4gICAgY29tcG9zaXRlQ3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdzb3VyY2Utb3Zlcic7XG4gIH1cbn1cblxuLyoqXG4gKiBDbGVhciBhIHNwZWNpZmljIGxheWVyXG4gKi9cbi8qKlxuICogQ2xlYXIgYSBsYXllclxuICovXG5mdW5jdGlvbiBjbGVhckxheWVyKGxheWVyKSB7XG4gIGNvbnN0IGN0eCA9IGxheWVyID09PSAnc2VlZCcgPyBzZWVkQ3R4IDogYm91bmRhcnlDdHg7XG4gIFxuICBpZiAobGF5ZXIgPT09ICdzZWVkJykge1xuICAgIC8vIFNlZWQgbGF5ZXI6IHdoaXRlIGJhY2tncm91bmQgKG5vIHNlZWQgcGF0dGVybilcbiAgICBjdHguZmlsbFN0eWxlID0gJyNmZmYnO1xuICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjdHguY2FudmFzLndpZHRoLCBjdHguY2FudmFzLmhlaWdodCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gQm91bmRhcnkgbGF5ZXI6IGZ1bGwgYmxhY2sgKGFsbCBjb25zdHJhaW5lZCAtIHVzZXIgZXJhc2VzIHRvIGFsbG93IHBhdHRlcm4pXG4gICAgY3R4LmZpbGxTdHlsZSA9ICcjMDAwJztcbiAgICBjdHguZmlsbFJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpO1xuICB9XG59XG5cbi8qKlxuICogTG9hZCBzZWVkIGRhdGEgZnJvbSBJbWFnZURhdGFcbiAqL1xuZnVuY3Rpb24gbG9hZFNlZWREYXRhKGltYWdlRGF0YSkge1xuICBzZWVkQ3R4LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xufVxuXG4vKipcbiAqIExvYWQgYm91bmRhcnkgZGF0YSBmcm9tIEZsb2F0MzJBcnJheVxuICovXG5mdW5jdGlvbiBsb2FkQm91bmRhcnlEYXRhKGJvdW5kYXJ5QXJyYXkpIHtcbiAgY29uc3Qgd2lkdGggPSBib3VuZGFyeUNhbnZhcy53aWR0aDtcbiAgY29uc3QgaGVpZ2h0ID0gYm91bmRhcnlDYW52YXMuaGVpZ2h0O1xuICBjb25zdCBpbWFnZURhdGEgPSBib3VuZGFyeUN0eC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7XG4gIFxuICAvLyBDb252ZXJ0IEZsb2F0MzJBcnJheSAoMC4wLTEuMCkgdG8gUkdCQVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvdW5kYXJ5QXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCB2YWx1ZSA9IGJvdW5kYXJ5QXJyYXlbaV0gPiAwLjUgPyAwIDogMjU1OyAgLy8gQmxhY2sgPSBpbnNpZGUsIHdoaXRlID0gb3V0c2lkZVxuICAgIGltYWdlRGF0YS5kYXRhW2kgKiA0XSA9IHZhbHVlO1xuICAgIGltYWdlRGF0YS5kYXRhW2kgKiA0ICsgMV0gPSB2YWx1ZTtcbiAgICBpbWFnZURhdGEuZGF0YVtpICogNCArIDJdID0gdmFsdWU7XG4gICAgaW1hZ2VEYXRhLmRhdGFbaSAqIDQgKyAzXSA9IDI1NTtcbiAgfVxuICBcbiAgYm91bmRhcnlDdHgucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG59XG5cbi8qKlxuICogU2F2ZSBjdXJyZW50IHN0YXRlIHRvIGhpc3RvcnlcbiAqL1xuZnVuY3Rpb24gc2F2ZVRvSGlzdG9yeSgpIHtcbiAgLy8gVHJ1bmNhdGUgaGlzdG9yeSBpZiB3ZSdyZSBub3QgYXQgdGhlIGVuZFxuICBpZiAoaGlzdG9yeUluZGV4IDwgc2VlZEhpc3RvcnkubGVuZ3RoIC0gMSkge1xuICAgIHNlZWRIaXN0b3J5ID0gc2VlZEhpc3Rvcnkuc2xpY2UoMCwgaGlzdG9yeUluZGV4ICsgMSk7XG4gICAgYm91bmRhcnlIaXN0b3J5ID0gYm91bmRhcnlIaXN0b3J5LnNsaWNlKDAsIGhpc3RvcnlJbmRleCArIDEpO1xuICB9XG4gIFxuICAvLyBBZGQgY3VycmVudCBzdGF0ZVxuICBzZWVkSGlzdG9yeS5wdXNoKHNlZWRDdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIHNlZWRDYW52YXMud2lkdGgsIHNlZWRDYW52YXMuaGVpZ2h0KSk7XG4gIGJvdW5kYXJ5SGlzdG9yeS5wdXNoKGJvdW5kYXJ5Q3R4LmdldEltYWdlRGF0YSgwLCAwLCBib3VuZGFyeUNhbnZhcy53aWR0aCwgYm91bmRhcnlDYW52YXMuaGVpZ2h0KSk7XG4gIFxuICBoaXN0b3J5SW5kZXgrKztcbiAgXG4gIC8vIExpbWl0IGhpc3Rvcnkgc2l6ZVxuICBpZiAoc2VlZEhpc3RvcnkubGVuZ3RoID4gTUFYX0hJU1RPUlkpIHtcbiAgICBzZWVkSGlzdG9yeS5zaGlmdCgpO1xuICAgIGJvdW5kYXJ5SGlzdG9yeS5zaGlmdCgpO1xuICAgIGhpc3RvcnlJbmRleC0tO1xuICB9XG59XG5cbi8qKlxuICogVW5kbyBsYXN0IGFjdGlvblxuICovXG5mdW5jdGlvbiB1bmRvKCkge1xuICBpZiAoaGlzdG9yeUluZGV4ID4gMCkge1xuICAgIGhpc3RvcnlJbmRleC0tO1xuICAgIHNlZWRDdHgucHV0SW1hZ2VEYXRhKHNlZWRIaXN0b3J5W2hpc3RvcnlJbmRleF0sIDAsIDApO1xuICAgIGJvdW5kYXJ5Q3R4LnB1dEltYWdlRGF0YShib3VuZGFyeUhpc3RvcnlbaGlzdG9yeUluZGV4XSwgMCwgMCk7XG4gICAgdXBkYXRlQ29tcG9zaXRlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWRvIGxhc3QgdW5kb25lIGFjdGlvblxuICovXG5mdW5jdGlvbiByZWRvKCkge1xuICBpZiAoaGlzdG9yeUluZGV4IDwgc2VlZEhpc3RvcnkubGVuZ3RoIC0gMSkge1xuICAgIGhpc3RvcnlJbmRleCsrO1xuICAgIHNlZWRDdHgucHV0SW1hZ2VEYXRhKHNlZWRIaXN0b3J5W2hpc3RvcnlJbmRleF0sIDAsIDApO1xuICAgIGJvdW5kYXJ5Q3R4LnB1dEltYWdlRGF0YShib3VuZGFyeUhpc3RvcnlbaGlzdG9yeUluZGV4XSwgMCwgMCk7XG4gICAgdXBkYXRlQ29tcG9zaXRlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBJbXBvcnQgaW1hZ2UgZmlsZVxuICovXG5mdW5jdGlvbiBpbXBvcnRJbWFnZShmaWxlLCBsYXllcikge1xuICBpZiAoIWZpbGUpIHJldHVybjtcbiAgXG4gIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4ge1xuICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICBjb25zdCBjdHggPSBsYXllciA9PT0gJ3NlZWQnID8gc2VlZEN0eCA6IGJvdW5kYXJ5Q3R4O1xuICAgICAgXG4gICAgICAvLyBEcmF3IGltYWdlIHRvIGxheWVyIGNhbnZhc1xuICAgICAgY3R4LmZpbGxTdHlsZSA9ICcjZmZmJztcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjdHguY2FudmFzLndpZHRoLCBjdHguY2FudmFzLmhlaWdodCk7XG4gICAgICBcbiAgICAgIC8vIFNjYWxlIGltYWdlIHRvIGZpdCBjYW52YXNcbiAgICAgIGNvbnN0IHNjYWxlID0gTWF0aC5taW4oXG4gICAgICAgIGN0eC5jYW52YXMud2lkdGggLyBpbWcud2lkdGgsXG4gICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0IC8gaW1nLmhlaWdodFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHggPSAoY3R4LmNhbnZhcy53aWR0aCAtIGltZy53aWR0aCAqIHNjYWxlKSAvIDI7XG4gICAgICBjb25zdCB5ID0gKGN0eC5jYW52YXMuaGVpZ2h0IC0gaW1nLmhlaWdodCAqIHNjYWxlKSAvIDI7XG4gICAgICBcbiAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCB4LCB5LCBpbWcud2lkdGggKiBzY2FsZSwgaW1nLmhlaWdodCAqIHNjYWxlKTtcbiAgICAgIFxuICAgICAgc2F2ZVRvSGlzdG9yeSgpO1xuICAgICAgdXBkYXRlQ29tcG9zaXRlKCk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGBJbXBvcnRlZCBpbWFnZSB0byAke2xheWVyfSBsYXllcmApO1xuICAgIH07XG4gICAgaW1nLnNyYyA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgfTtcbiAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XG59XG5cbi8qKlxuICogRXhwb3J0IGxheWVyIGFzIFBOR1xuICovXG5mdW5jdGlvbiBleHBvcnRMYXllcihsYXllcikge1xuICBjb25zdCBjYW52YXMgPSBsYXllciA9PT0gJ3NlZWQnID8gc2VlZENhbnZhcyA6IGJvdW5kYXJ5Q2FudmFzO1xuICBjb25zdCBkYXRhVVJMID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7XG4gIFxuICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICBsaW5rLmRvd25sb2FkID0gYCR7bGF5ZXJ9LSR7RGF0ZS5ub3coKX0ucG5nYDtcbiAgbGluay5ocmVmID0gZGF0YVVSTDtcbiAgbGluay5jbGljaygpO1xuICBcbiAgY29uc29sZS5sb2coYEV4cG9ydGVkICR7bGF5ZXJ9IGxheWVyYCk7XG59XG5cbi8qKlxuICogQXBwbHkgZHJhd2luZyB0byBzaW11bGF0aW9uXG4gKi9cbmZ1bmN0aW9uIGFwcGx5RHJhd2luZygpIHtcbiAgLy8gR2V0IHNlZWQgZGF0YVxuICBjb25zdCBzZWVkSW1hZ2VEYXRhID0gc2VlZEN0eC5nZXRJbWFnZURhdGEoMCwgMCwgc2VlZENhbnZhcy53aWR0aCwgc2VlZENhbnZhcy5oZWlnaHQpO1xuICBcbiAgLy8gR2V0IGJvdW5kYXJ5IGRhdGFcbiAgY29uc3QgYm91bmRhcnlJbWFnZURhdGEgPSBib3VuZGFyeUN0eC5nZXRJbWFnZURhdGEoMCwgMCwgYm91bmRhcnlDYW52YXMud2lkdGgsIGJvdW5kYXJ5Q2FudmFzLmhlaWdodCk7XG4gIFxuICAvLyBDaGVjayBpZiBib3VuZGFyeSBoYXMgYW55IGNvbnRlbnQgKG5vbi10cmFuc3BhcmVudCBwaXhlbHMpXG4gIGxldCBoYXNCb3VuZGFyeUNvbnRlbnQgPSBmYWxzZTtcbiAgZm9yIChsZXQgaSA9IDM7IGkgPCBib3VuZGFyeUltYWdlRGF0YS5kYXRhLmxlbmd0aDsgaSArPSA0KSB7XG4gICAgaWYgKGJvdW5kYXJ5SW1hZ2VEYXRhLmRhdGFbaV0gPiAxMjgpIHsgIC8vIEFscGhhIGNoYW5uZWwgPiAxMjhcbiAgICAgIGhhc0JvdW5kYXJ5Q29udGVudCA9IHRydWU7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgXG4gIC8vIFN0b3JlIGluIGdsb2JhbCBmb3IgYWNjZXNzIGJ5IGZpcnN0RnJhbWUuanNcbiAgZ2xvYmFsLmN1c3RvbURyYXdpbmdTZWVkID0gc2VlZEltYWdlRGF0YTtcbiAgZ2xvYmFsLmN1c3RvbURyYXdpbmdCb3VuZGFyeSA9IGJvdW5kYXJ5SW1hZ2VEYXRhO1xuICBcbiAgLy8gSWYgYm91bmRhcnkgaGFzIGNvbnRlbnQsIGVuYWJsZSBib3VuZGFyeSBjb25kaXRpb25zXG4gIGlmIChoYXNCb3VuZGFyeUNvbnRlbnQpIHtcbiAgICBwYXJhbWV0ZXJWYWx1ZXMuYm91bmRhcnkuZW5hYmxlZCA9IHRydWU7XG4gICAgY29uc29sZS5sb2coJ0JvdW5kYXJ5IGRyYXdpbmcgZGV0ZWN0ZWQgLSBlbmFibGluZyBib3VuZGFyeSBjb25kaXRpb25zJyk7XG4gIH1cbiAgXG4gIC8vIENsb3NlIG1vZGFsXG4gIGNsb3NlRHJhd2luZ0VkaXRvcigpO1xuICBcbiAgLy8gQXBwbHkgdG8gc2ltdWxhdGlvblxuICBkcmF3Rmlyc3RGcmFtZShJbml0aWFsVGV4dHVyZVR5cGVzLkRSQVdJTkcpO1xuICBcbiAgY29uc29sZS5sb2coJ0FwcGxpZWQgZHJhd2luZyB0byBzaW11bGF0aW9uJywge1xuICAgIGhhc0JvdW5kYXJ5OiBoYXNCb3VuZGFyeUNvbnRlbnQsXG4gICAgYm91bmRhcnlFbmFibGVkOiBwYXJhbWV0ZXJWYWx1ZXMuYm91bmRhcnkuZW5hYmxlZFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJtb2RhbCIsInNlZWRDYW52YXMiLCJib3VuZGFyeUNhbnZhcyIsImNvbXBvc2l0ZUNhbnZhcyIsInNlZWRDdHgiLCJib3VuZGFyeUN0eCIsImNvbXBvc2l0ZUN0eCIsImV2ZW50TGlzdGVuZXJzU2V0dXAiLCJjdXJyZW50VG9vbCIsImN1cnJlbnRMYXllciIsImJydXNoU2l6ZSIsImlzRHJhd2luZyIsInNlZWRIaXN0b3J5IiwiYm91bmRhcnlIaXN0b3J5IiwiaGlzdG9yeUluZGV4IiwiTUFYX0hJU1RPUlkiLCJzaG93U2VlZCIsInNob3dCb3VuZGFyeSIsIm9wZW5EcmF3aW5nRWRpdG9yIiwib3B0aW9ucyIsImV4aXN0aW5nU2VlZCIsImV4aXN0aW5nQm91bmRhcnkiLCJpbWFnZURhdGEiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpZCIsImNsYXNzTmFtZSIsImlubmVySFRNTCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsInNlZWRGaWxlSW5wdXQiLCJ0eXBlIiwiYWNjZXB0Iiwic3R5bGUiLCJkaXNwbGF5IiwiYm91bmRhcnlGaWxlSW5wdXQiLCJjcmVhdGVNb2RhbCIsIndpZHRoIiwiY2FudmFzIiwiaGVpZ2h0IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0Iiwid2lsbFJlYWRGcmVxdWVudGx5IiwiaW5pdGlhbGl6ZUNhbnZhc2VzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsb3NlRHJhd2luZ0VkaXRvciIsImUiLCJ0YXJnZXQiLCJ2YWx1ZSIsInVwZGF0ZUNvbXBvc2l0ZSIsImNoZWNrZWQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImJ0biIsImIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJkYXRhc2V0IiwidG9vbCIsImJydXNoU2l6ZVNsaWRlciIsImJydXNoU2l6ZVZhbHVlIiwicGFyc2VJbnQiLCJ0ZXh0Q29udGVudCIsInN0YXJ0RHJhd2luZyIsImRyYXciLCJzdG9wRHJhd2luZyIsInVuZG8iLCJyZWRvIiwiY2xlYXJMYXllciIsInNhdmVUb0hpc3RvcnkiLCJjbGljayIsImltcG9ydEltYWdlIiwiZmlsZXMiLCJleHBvcnRMYXllciIsImFwcGx5RHJhd2luZyIsImhhbmRsZUtleWJvYXJkIiwic2V0dXBFdmVudExpc3RlbmVycyIsInB1dEltYWdlRGF0YSIsImJvdW5kYXJ5QXJyYXkiLCJjcmVhdGVJbWFnZURhdGEiLCJpIiwibGVuZ3RoIiwiZGF0YSIsImxvYWRCb3VuZGFyeURhdGEiLCJjb25zb2xlIiwibG9nIiwia2V5IiwicXVlcnlTZWxlY3RvciIsImN0cmxLZXkiLCJwcmV2ZW50RGVmYXVsdCIsIk1hdGgiLCJtYXgiLCJtaW4iLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiZHJhd1BvaW50IiwiY2xpZW50WCIsImxlZnQiLCJjbGllbnRZIiwidG9wIiwieCIsInkiLCJjdHgiLCJnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24iLCJmaWxsU3R5bGUiLCJiZWdpblBhdGgiLCJhcmMiLCJQSSIsImZpbGwiLCJmaWxsUmVjdCIsImdsb2JhbEFscGhhIiwiZHJhd0ltYWdlIiwidGVtcENhbnZhcyIsInRlbXBDdHgiLCJsYXllciIsInNsaWNlIiwicHVzaCIsImdldEltYWdlRGF0YSIsInNoaWZ0IiwiZmlsZSIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJpbWciLCJJbWFnZSIsInNjYWxlIiwic3JjIiwicmVzdWx0IiwicmVhZEFzRGF0YVVSTCIsImRhdGFVUkwiLCJ0b0RhdGFVUkwiLCJsaW5rIiwiZG93bmxvYWQiLCJEYXRlIiwibm93IiwiaHJlZiIsInNlZWRJbWFnZURhdGEiLCJib3VuZGFyeUltYWdlRGF0YSIsImhhc0JvdW5kYXJ5Q29udGVudCIsImciLCJjdXN0b21EcmF3aW5nU2VlZCIsImN1c3RvbURyYXdpbmdCb3VuZGFyeSIsImJvdW5kYXJ5IiwiZW5hYmxlZCIsIkRSQVdJTkciLCJoYXNCb3VuZGFyeSIsImJvdW5kYXJ5RW5hYmxlZCJdLCJzb3VyY2VSb290IjoiIn0=